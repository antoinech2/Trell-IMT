<div class="container-popup row justify-content-center">
    <div class="messagepop" id="task_popup" data-user_type="{{ user_type.name }}">
        <h5 id="task_form_label"></h5>
        <form id="new_task">
            <div class="row mb-3">
                <div class="d-flex ">
                    <i class="bi bi-card-checklist icon"></i>
                    <label for="task_form_title">Task title</label>
                </div>
                <input type="text" class="form-control" size="30" name="title" id="task_form_title"
                       required {{ "disabled" if user_type.name == "Developer" else "" }}/>
            </div>
            <div class="row mb-3">
                <div class="d-flex ">
                    <i class="bi bi-file-earmark-richtext icon"></i>
                    <label for="task_form_description">Description</label>
                </div>
                <textarea class="form-control" rows="3" name="description" id="task_form_description"
                          cols="35" {{ "disabled" if user_type.name == "Developer" else "" }}></textarea>
            </div>

            <div class="row mb-3">
                <div class="d-flex">
                    <i class="bi bi-calendar-plus icon"></i>
                    <label for="task_form_expires_on">End date</label>
                </div>
                <input type="datetime-local" class="form-control mb-3" id="task_form_expires_on"
                       name="task-end" {{ "disabled" if user_type.name == "Developer" else "" }}/>
            </div>
            <hr/>
            <div class="row mb-3 mt-3">
                <div class="progress-container">
                    <div class="row">
                        <div class="col-8">
                            <i class="bi bi-bar-chart"></i>
                            <span> Tasks progression</span>
                        </div>
                        <div class="col-3">
                            <i class="bi bi-clipboard-check"></i>
                            <span id="task_done"></span>
                        </div>

                    </div>
                    <div class="progress" role="progressbar" aria-label="task_progression" aria-valuenow="25"
                         aria-valuemin="0" aria-valuemax="100">
                        <div id="task_progress_form" class="progress-bar bg-success" style="width: 25%">25%</div>
                    </div>
                </div>

                <div class="d-flex mt-3">
                    <i class="bi bi-list-task"></i>
                    <h6> Subtasks </h6>
                </div>

                <div id="sub_task_list_form"></div>
                <div class="row mb-3">
                    <div class="d-flex mt-3">
                        <i class="bi bi-file-earmark-plus icon "></i>
                        <label for="new_subtask_input">New sub-task</label>
                    </div>
                    <div class="col-6">
                        <input id="new_subtask_input" class="form-control" name="new_subtask_input" type="text"
                               form="none" placeholder="Subtask">
                    </div>
                    <div class="col-4">
                        <button type="button" id="add_subtask" class="btn btn-outline-secondary button-right">+ Add a
                            subtask
                        </button>
                    </div>
                </div>
            </div>
            <hr/>


            <div class="row mb-3 mt-3">
                <div class="d-flex">
                    <i class="bi bi-bookmarks-fill"></i>
                    <h6>Etiquettes</h6>
                </div>
                <div id="etiquettes_list_form" class="container-etiquette">
                </div>
                <div class="dropup">
                    <button class="btn btn-outline-dark dropdown-toggle" type="button" data-bs-toggle="dropdown"
                            aria-expanded="false">
                        <i class="bi bi-bookmark-plus-fill"></i> Add etiquettes
                    </button>
                    <ul class="dropdown-menu">
                        {% for type, etiquettes in etiquette.items() %}
                            {% if not (type == "priority" and user_type.name == "Developer") %}
                                <li>
                                    <a class="dropdown-item btn">
                                        {{ type.capitalize() }} &raquo;
                                    </a>
                                    <ul class="dropdown-menu dropdown-submenu">
                                        {% for sub_etiquette in etiquettes.values() %}
                                            <li>
                                                <a class="dropdown-item btn add_etiquette"
                                                   title="{{ sub_etiquette.description }}"
                                                   data-etiquette_id="{{ sub_etiquette.id }}"
                                                   data-etiquette_color="{{ sub_etiquette.color }}"
                                                   data-etiquette_description="{{ sub_etiquette.description }}"
                                                   data-etiquette_type= {{ sub_etiquette.type }}>
                                                    {{ sub_etiquette.label }}
                                                </a>
                                            </li>
                                        {% endfor %}
                                    </ul>
                                </li>
                            {% endif %}
                        {% endfor %}

                    </ul>
                </div>

            </div>


            <hr/>
            <div class="row mb-3 mt-3">
                <div class="d-flex">
                    <i class="bi bi-people-fill"></i>
                    <h6>Collaborators</h6>
                </div>
                <ul id="collaborators">
                </ul>
                {% if user_type.name != "Developer" %}
                    <div class="d-flex">
                        <i class="bi bi-person-plus-fill"></i>
                        <label for="search_user">Add collaborator</label>
                    </div>
                    <input type="search" id="search_user" name="search_user" class="form-control" autocomplete="off"/>
                    <ul id="user_list" class="list-group">
                    </ul>
                {% endif %}
            </div>


            <div class="link">
                <a class="close btn btn-outline-danger" href="/">Cancel</a>
                <input type="submit" class="btn btn-outline-success button-right" value="Add task" name="commit"
                       id="task_form_submit"/>
            </div>
        </form>
        <form id="delete_task" action="/delete_task" method="post">
            <button type="submit" name="delete" class="btn btn-danger">
                <i class="bi bi-trash3"></i> Delete
            </button>
        </form>
    </div>
</div>
